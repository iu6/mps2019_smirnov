/* Includes ------------------------------------------------------------------*/
//#include "MDR32F9Qx_board.h"
#include "MDR32F9Qx_config.h"
#include "MDR32F9Qx_port.h"
#include <MDR32F9Qx_rst_clk.h>
#include "MDR32F9Qx_eeprom.h"           // Keil::Drivers:EEPROM

//opredelenie zaderzhki
#define DELAY(T) for (i = T; i > 0; i--) 
int i;

//NASTROYKA TAKTIROVANIYA 12MHZ
void MY_U_RST_Init(void)
{
	// ???????? ???????????? ??????????? ?????
	RST_CLK_PCLKcmd (RST_CLK_PCLK_BKP, ENABLE);
	// ???????? ????????? ?? ??????? ??????
	RST_CLK_HSEconfig (RST_CLK_HSE_ON);
	while (RST_CLK_HSEstatus () != SUCCESS);
	// ??????????? ???????? ? ??????????? ????????? PLL
	// (CPU_C1_SEL = HSE / 1 * 10 = 8 ??? / 1 * 10 = 80 ???)
	//8MHZ/2*3 = 12MHZ
	RST_CLK_CPU_PLLconfig (RST_CLK_CPU_PLLsrcHSEdiv2,
	RST_CLK_CPU_PLLmul3);
	// ???????? PLL, ?? ??? ?? ?????????? ? ?????????
	RST_CLK_CPU_PLLcmd (ENABLE);
	while (RST_CLK_CPU_PLLstatus () != SUCCESS);
	// ???????? ?3 ( CPU_C3_SEL = CPU_C2_SEL )
	RST_CLK_CPUclkPrescaler (RST_CLK_CPUclkDIV1);
	// ?? ?2 ???? ? PLL, ? ?? ???????? ? ?1 (CPU_C2_SEL = PLL)
	RST_CLK_CPU_PLLuse (ENABLE);
	// CPU ????? ???????????? ? ?????? ?3
	// (HCLK_SEL = CPU_C3_SEL = 80 ???)
	RST_CLK_CPUclkSelection (RST_CLK_CPUclkCPU_C3);
}

void ports_init(void){
	RST_CLK_PCLKcmd(RST_CLK_PCLK_PORTC, ENABLE);
	
	PORT_InitTypeDef nastroyka_c;
	PORT_StructInit(&nastroyka_c);
	
	nastroyka_c.PORT_OE = PORT_OE_OUT;
	nastroyka_c.PORT_SPEED = PORT_SPEED_SLOW;
	nastroyka_c.PORT_MODE = PORT_MODE_DIGITAL;
	
	PORT_Init( MDR_PORTC, &nastroyka_c);
}




int main () {
	MY_U_RST_Init();
	ports_init();
			 while (1) { 
				   PORT_SetBits(MDR_PORTC, PORT_Pin_0);
					 DELAY(300000);
					 PORT_ResetBits(MDR_PORTC, PORT_Pin_0);
				   DELAY(300000);
				}	
}

